"use strict";(self["webpackChunkningmao_gallery"]=self["webpackChunkningmao_gallery"]||[]).push([[72],{3960:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var o=t(6185),s=t(2432),n=t(1172),r=t.p+"img/ningmao-macost.f7b0898d.png";const i={class:"login-page"},l={class:"login-box"},d={class:"form-group"},u={class:"form-group"},g=["disabled"];function p(e,a,t,p,c,m){return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",l,[a[5]||(a[5]=(0,o.Lk)("div",{class:"mascot"},[(0,o.Lk)("img",{src:r,alt:"宁猫酱"})],-1)),a[6]||(a[6]=(0,o.Lk)("h2",null,"宁猫的图片管理",-1)),(0,o.Lk)("div",d,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>c.username=e),placeholder:"用户名",onKeyup:a[1]||(a[1]=(0,s.jR)(((...e)=>m.login&&m.login(...e)),["enter"]))},null,544),[[s.Jo,c.username]])]),(0,o.Lk)("div",u,[(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":a[2]||(a[2]=e=>c.password=e),placeholder:"密码",onKeyup:a[3]||(a[3]=(0,s.jR)(((...e)=>m.login&&m.login(...e)),["enter"]))},null,544),[[s.Jo,c.password]])]),(0,o.Lk)("button",{onClick:a[4]||(a[4]=(...e)=>m.login&&m.login(...e)),disabled:c.loading},(0,n.v_)(c.loading?"登录中...":"登录"),9,g)])])}t(5226);var c=t(6394),m={name:"Login",data(){return{username:"",password:"",loading:!1}},created(){const e=localStorage.getItem("token"),a=localStorage.getItem("tokenExpires");e&&a&&Date.now()<parseInt(a)&&"/login"===this.$route.path&&this.$router.push("/")},methods:{async login(){if(this.username&&this.password){this.loading=!0;try{const e=await c.A.post("/login",{username:this.username,password:this.password});e.data.success&&(localStorage.setItem("token",e.data.data.token),localStorage.setItem("tokenExpires",Date.now()+36e5*e.data.data.expires),c.A.defaults.headers.common["Authorization"]=`Bearer ${e.data.data.token}`,this.$router.push("/"),this.$emit("show-toast","登录成功"))}catch(e){this.$emit("show-toast",e.response?.data?.message||"登录失败","error")}finally{this.loading=!1}}else this.$emit("show-toast","请输入用户名和密码","error")}}},h=t(820);const k=(0,h.A)(m,[["render",p],["__scopeId","data-v-18635504"]]);var w=k}}]);
//# sourceMappingURL=72.8c04ff36.js.map